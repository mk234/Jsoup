<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>API Mapy.cz</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript" src="novinky-frame_data/loader.js"></script>
    <script type="text/javascript">
        Loader.load();
    </script>
    <script charset="utf-8" type="text/javascript" src="novinky-frame_data/smap-jak.js"></script>
    <link rel="stylesheet" type="text/css" href="novinky-frame_data/smap-jak.css">
    <script charset="utf-8" type="text/javascript" src="novinky-frame_data/config.js"></script>
    <style type="text/css">
        body {
            font-family: Arial, Verdana, sans-serif;
            font-size: 13px;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        #mapy-routeForm-box {
            margin: 3px 0 0 0;
            height: 30px;
            font-size: 13px;
            line-height: 17px;
            overflow: hidden;
        }

        .smap .card .card-body {
            overflow: hidden !important;
        }

        #map .card .card-body {
            background: none;
        }
    </style>
</head>
<body data-linkificator-status="complete" data-linkificator-count="0" data-linkificator-time="10">
<div id="content">
    <style>
        #map .card {
            border: 2px solid #fff;
            border-radius: 8px;
            padding: 5px 10px;
            background: #000;
            background: rgba(0, 0, 0, 0.7);
            color: #fff;
            font-weight: bold;
        }

        #map .card .card-headr,
        #map .card .card-footer,
        #map .card .close,
        #map .card .tail {
            display: none;
        }

        #map .card:after, .card:before {
            right: 100%;
            border: solid transparent;
            content: " ";
            height: 0;
            width: 0;
            position: absolute;
            pointer-events: none;
        }

        #map .card:after {
            border-top-color: #000;
            border-top-color: rgba(0, 0, 0, 0.7);
            border-width: 5px;
            top: 100%;
            left: 24px;
        }

        #map .card:before {
            border-top-color: #fff;
            border-width: 9px;
            top: 100%;
            left: 20px;
        }

    </style>
    <div id="map" class="smap" style="height: 275px;">
        <div style="position: absolute; width: 0px; height: 0px; margin: 0px; padding: 0px; left: 200px; top: 137.5px;">
            <div>
                <div id="1-0-0.42970159600766544">
                    <div style="transform: translateZ(0px);"><img
                            style="position: absolute; opacity: 1; transition: opacity 600ms ease 0s; left: -320.415px; top: -382.113px; height: 256px; width: 256px;"
                            src="novinky-frame_data/11-1103-692.png"><img
                            style="position: absolute; opacity: 1; transition: opacity 600ms ease 0s; left: -320.415px; top: -126.113px; height: 256px; width: 256px;"
                            src="novinky-frame_data/11-1103-693.png"><img
                            style="position: absolute; opacity: 1; transition: opacity 600ms ease 0s; left: -320.415px; top: 129.887px; height: 256px; width: 256px;"
                            src="novinky-frame_data/11-1103-694.png"><img
                            style="position: absolute; opacity: 1; transition: opacity 600ms ease 0s; left: -64.4148px; top: -382.113px; height: 256px; width: 256px;"
                            src="novinky-frame_data/11-1104-692.png"><img
                            style="position: absolute; opacity: 1; transition: opacity 600ms ease 0s; left: -64.4148px; top: -126.113px; height: 256px; width: 256px;"
                            src="novinky-frame_data/11-1104-693.png"><img
                            style="position: absolute; opacity: 1; transition: opacity 600ms ease 0s; left: -64.4148px; top: 129.887px; height: 256px; width: 256px;"
                            src="novinky-frame_data/11-1104-694.png"><img
                            style="position: absolute; opacity: 1; transition: opacity 600ms ease 0s; left: 191.585px; top: -382.113px; height: 256px; width: 256px;"
                            src="novinky-frame_data/11-1105-692.png"><img
                            style="position: absolute; opacity: 1; transition: opacity 600ms ease 0s; left: 191.585px; top: -126.113px; height: 256px; width: 256px;"
                            src="novinky-frame_data/11-1105-693.png"><img
                            style="position: absolute; opacity: 1; transition: opacity 600ms ease 0s; left: 191.585px; top: 129.887px; height: 256px; width: 256px;"
                            src="novinky-frame_data/11-1105-694.png"></div>
                </div>
            </div>
            <div>
                <div id="0.3320590986691295-1"></div>
            </div>
            <svg xlink="http://www.w3.org/1999/xlink" width="400" height="275"
                 style="position: absolute; left: -200px; top: -137.5px;">
                <g></g>
            </svg>
            <div>
                <div id="0.3320590986691295-3" style="transform: none;"><img src="novinky-frame_data/balloon-2.png"
                                                                             style="position: absolute; left: -9.2507px; top: 7.87512px;">
                </div>
            </div>
            <div>
                <div id="0.3320590986691295-4"></div>
            </div>
            <div class="card" style="touch-action: none; width: 85px; visibility: visible; left: -30px; bottom: -2px;">
                <div class="card-header"></div>
                <div class="card-body" style="">Místo nehody</div>
                <div class="card-footer"></div>
                <div class="tail"></div>
            </div>
        </div>
        <div class="hud">
            <div class="noprint">
                <div class="copyright print"
                     style="position: absolute; left: 5px; bottom: 3px; right: auto; top: auto;">© <a
                        href="https://www.seznam.cz/" target="_blank" rel="noopener">Seznam.cz, a.s.</a>, © <a
                        href="https://www.openstreetmap.org/copyright" target="_blank" rel="noopener">OpenStreetMap</a>
                </div>
                <a class="print" target="_blank"
                   style="position: absolute; right: 0px; bottom: 0px; left: auto; top: auto;"
                   href="https://mapy.cz/?x=14.106730&amp;y=50.121409&amp;z=11"><img src="novinky-frame_data/logo.png"></a><img
                    class="overview-map" style="position: absolute;" src="novinky-frame_data/0_7e00000_81c0000.png">
            </div>
        </div>
    </div>
    <script>

        SMap.Card.prototype.$constructor = function (width) {
            this._ec = [];
            this._sc = [];
            this._options = {
                close: false
            };
            this._anchor = false;
            this._owner = null;
            this._size = [null, null];
            this._minHeight = null;
            this._tailPointer = [29, -50];
            /* FIXME */

            this._dom = {
                container: null,
                close: null,
                tail: null,
                header: JAK.mel("div", {className: "card-header"}),
                body: JAK.mel("div", {className: "card-body"}),
                footer: JAK.mel("div", {className: "card-footer"})
            };

            this._build();
            this._addEvents();
            this.setSize(width || 311);
        };

        SMap.Card.prototype._computePosition = function (coords) {
            var map = this.getMap();
            var px = coords.toPixel(map).minus(map.getOffset());
            var tail = this._dom.tail;
            px.x -= (tail.offsetLeft + this._tailPointer[0]);
            px.y += (14 + this._tailPointer[1]);
            return px;
        };

        // uprava metody pro otevreni vizitky, aby bylo mozne mit jich otevreno vice
        SMap.prototype.addCard = function (card, coords, noPan) {
            //this.removeCard();
            this._card = card;
            var c = card.getContainer();
            c.style.visibility = "hidden";
            this._dom.content.appendChild(c);
            card.setOwner(this);
            card.anchorTo(coords);
            c.style.visibility = "visible";

            this._signals.makeEvent("card-open", this._card);
            if (!noPan) {
                card.makeVisible();
            }
        };

        var MAPSET = {"1": "zakladni", "2": "turisticka", "3": "letecka", "30": "zimni"};
        var WORLD_START_POINTER_COORDS = [180, 80];
        var WORLD_START_POINTER_IN_PIXELS = [4, 4];
        var WORLDMAP_SIZE = [122, 84];

        var CONF = {};
        var urlParams = window.location.search.substr(1).split("&");
        for (var i = 0; i < urlParams.length; i++) {
            var param = urlParams[i].split("=");
            if (decodeURIComponent(param[0]) == "params" && param.length == 2) {
                try {
                    CONF = JSON.parse(decodeURIComponent(param[1]));
                } catch (ex) {
                }
            }
        }
        CONF.apiURL = "api.mapy.cz";

        var params = CONF;
        var center = SMap.Coords.fromWGS84(params.x, params.y);
        var mapa = new SMap(JAK.gel("map"), center, params.zoom);
        var card = [];

        mapa.addDefaultLayer(params.base).enable();

        // pridani bodu
        if (params.pc) {
            var layer = new SMap.Layer.Marker();
            mapa.addLayer(layer);
            layer.enable();

            for (var i = 0; i < params.pc.length; i++) {
                var mCenter = SMap.Coords.stringToCoords(params.pc[i])[0];

                // vytvoreni vizitky k bodu
                if (params.pt[i] != "") {
                    var c = new SMap.Card(params.pts[i]);
                    c.getBody().appendChild(document.createTextNode(params.pt[i]));
                }

                //var marker = new SMap.Marker(mCenter, null, {anchor: {left:14, top:49}, url:SMap.CONFIG.img + "/marker/balloon-2.png"});
                var marker = new SMap.Marker(mCenter, null, {
                    anchor: {left: 8, top: 30},
                    url: SMap.CONFIG.img + "/marker/balloon-2.png"
                });

                if (params.pt[i] != "") {
                    //marker.decorate(SMap.Marker.Feature.Card, c);
                    mapa.addCard(c, mCenter, true);
                    card.push(c);
                }

                layer.addMarker(marker);
            }

            var signals = mapa.getSignals();
            signals.addListener(window, "map-redraw", function () {
                for (var i = 0; i < card.length; i++) {
                    card[i].sync();
                }
            });
        }

        // pridani obrazku
        if (params.img) {
            var pos = {top: "8px", right: "8px", bottom: "20px", left: "8px"};
            var select = parseInt(params.imgPos);

            if ([0, 1].indexOf(select) > -1) {
                delete pos.bottom;
            }
            if ([2, 3].indexOf(select) > -1) {
                delete pos.top;
            }
            if ([0, 3].indexOf(select) > -1) {
                delete pos.right;
            }
            if ([1, 2].indexOf(select) > -1) {
                delete pos.left;
            }

            if (select == 2) {
                pos.bottom = "30px";
            }

            img = new SMap.Control.Image(params.img);
            mapa.addControl(img, pos);
        }

        var mapURL = "//mapy.cz";
        var addParams = [];

        if (params.x) {
            addParams.push({key: "x", val: params.x});
        }
        if (params.y) {
            addParams.push({key: "y", val: params.y});
        }
        if (params.zoom) {
            addParams.push({key: "z", val: params.zoom});
        }

        for (var i = 0; i < addParams.length; i++) {
            if (i == 0) {
                mapURL += "/?";
            }

            mapURL += addParams[i].key + "=" + addParams[i].val;

            if (i != addParams.length - 1) {
                mapURL += "&";
            }
        }

        var controls = [
            {
                ctor: SMap.Control.Sync,
                opt: {bottomSpace: 0},
                placement: null,
                inst: null
            }
        ];

        for (var i = 0; i < controls.length; i++) {
            var c = controls[i];
            c.inst = new c.ctor(c.opt);
            mapa.addControl(c.inst, c.placement);
        }

        // nahledova mapka
        if (params.overview) {
            switch (params.overview) {
                case 1:
                    mapa.addControl(new SMap.Control.Overview());
                    break;

                case 2:
                    var worldOverview = new SMap.Control.Visible();
                    worldOverview._build();

                    var con = worldOverview.getContainer();
                    var img = document.createElement("img");
                    var point = document.createElement("div");
                    var pleft = WORLDMAP_SIZE[0] / 360 * center.x + WORLD_START_POINTER_IN_PIXELS[0] + WORLDMAP_SIZE[0] / 2 - 6;
                    var ptop = WORLDMAP_SIZE[1] / 180 * center.y * -1 + WORLD_START_POINTER_IN_PIXELS[1] + WORLDMAP_SIZE[1] / 2 - 6;

                    img.src = "/img/web/world-overview.png";
                    img.alt = "";

                    point.style.position = "absolute";
                    point.style.width = "10px";
                    point.style.height = "10px";
                    point.style.border = "1px solid #fff";
                    point.style.borderRadius = "50%";
                    point.style.backgroundColor = "#1a389a";
                    point.style.left = pleft + "px";
                    point.style.top = ptop + "px";

                    con.appendChild(img);
                    con.appendChild(point);

                    mapa.addControl(worldOverview);
                    break;
            }
        }

        var createURLToMapy = function () {
            var href = "//mapy.cz/" + MAPSET[params.base] + "?";
            if (params.pc) {
                href += "vlastni-body&";
            }
            href += "x=" + params.x;
            href += "&y=" + params.y;
            href += "&z=" + params.zoom;
            if (params.pc) {
                var uc = [];
                for (var i = 0; i < params.pc.length; i++) {
                    uc.push(SMap.Coords.stringToCoords(params.pc[i])[0]);
                    href += "&ut=" + params.pt[i];
                }
                href += "&uc=" + SMap.Coords.coordsToString(uc);
            }
            return href;
        };

        var aMapy = document.createElement("a");
        document.body.appendChild(aMapy);
        aMapy.href = createURLToMapy();
        aMapy.target = "_blank";
        aMapy.style.position = "absolute";
        aMapy.style.top = "0";
        aMapy.style.left = "0";
        aMapy.style.bottom = "0";
        aMapy.style.right = "0";
        aMapy.style.background = "rgba(255,255,255,0.01)";
        aMapy.style.zIndex = 5;
    </script>
</div>
<a href="https://mapy.cz/zakladni?vlastni-body&amp;x=14.106730108984408&amp;y=50.121408736739674&amp;z=11&amp;ut=M%C3%ADsto%20nehody&amp;uc=9gFuQxYBdt"
   target="_blank"
   style="position: absolute; top: 0px; left: 0px; bottom: 0px; right: 0px; background: rgba(255, 255, 255, 0.01) none repeat scroll 0% 0%; z-index: 5;"></a>
<!--
-->

</body>
</html>