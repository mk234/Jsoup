/*
  Audience Manager Configuration Script
    Version 16.11.22 - Standalone
            CDN edition
        Code name: Progress 3
     Developed by Optimics s.r.o.
*/ 

!function(a){var b={},c=window,d=document,e={};e.dat=a,b.version="16.11.22 - Standalone CDN Edition - Progress 3",e.noop=function(){},e.cookie={set:function(a,b,c){var d;if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toGMTString()}else d="";var f=location.hostname.split("."),g=f.pop(),h=f.pop(),i="."+h+"."+g;document.cookie=a+"="+b+d+";path=/;domain="+i},get:function(a){if(document.cookie.length>0){var b=document.cookie.indexOf(a+"=");if(b!=-1){b=b+a.length+1;var c=document.cookie.indexOf(";",b);return c==-1&&(c=document.cookie.length),unescape(document.cookie.substring(b,c))}}return""},find:function(a){var d,b=document.cookie.split(/;\s*/),c=[];for(d=0;d<b.length;d++)b[d].match(a)&&c.push(b[d]);return c}},e.merge_options=function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c},e.hasOwnProperty=Object.prototype.hasOwnProperty,e.isEmpty=function(a){if(null==a)return!0;if(a.length>0)return!1;if(0===a.length)return!0;for(var b in a)if(e.hasOwnProperty.call(a,b))return!1;return!0},e.isIn=function(a,b,c){if(!e.isEmpty(a))for(var d in b)if(b.hasOwnProperty(d)){var f=b[d];1==c&&(f="^"+f+"$");var g=new RegExp(f);if(g.test(a))return b[d]}return!1},e.once=function(a){var c,b=!1;return function(){return b?c:(b=!0,c=a.apply(this,arguments),a=null,c)}},e.defaults={api:"cpex_AAM",cookie:{aamUUID:"aam_uuid",aamLast:"aam_last",aamFirst:"aam_first",aamTimeDependencyPrefix:"aam_td_",aamSlowDeployPrefix:"aam_sd_",aamSignalStoragePrefix:"aam_sig_",aamIdSync:"aam_net_ui",aamIdSyncTime:"aam_net_ts"},behavior:{shortener:!0,debug:!1,serviceCall:!0,autofire:!0,trackLinks:!0},excluded:{browsers:["IE8"]},allowed:{devices:["Desktop"],os:["MacOS","Windows","Unix","Linux"]},searchEngines:{hostPattern:/(search\.seznam\.cz|search\.centrum\.cz|searchatlas\.centrum\.cz|search\.volny\.cz)/,queryParam:"q"},searchQueries:["q","query","search","what","h[fraze]","txt_search"],extensions:{cpex_network:{release:"1432745643240",period:86.4,min:20,max:100}},addons:{}},e.MergeRecursive=function(a,b){for(var c in b)try{b[c].constructor==Object?a[c]=e.MergeRecursive(a[c],b[c]):a[c]=b[c]}catch(d){a[c]=b[c]}return a},e.dat=e.MergeRecursive(e.defaults,e.dat),"dev"==e.cookie.get("aam_lib")&&(e.dat.behavior.debug=!0),e.notify=function(){var a=e.dat.behavior.debug||!1,b=console;e.notify.log=function(c,d){if(a)switch(d){case 1:case 2:case 3:b.log("AAM: "+c);break;case 4:b.warn("AAM: "+c);break;case 5:b.error("AAM: "+c);break;default:b.log("AAM: Notify called with incorrect priority.")}},e.notify.group=function(c){a?b.group(c):""},e.notify.groupCollapsed=function(c){a?b.groupCollapsed(c):""},e.notify.groupEnd=function(){a?b.groupEnd():""},e.notify.table=function(c){a?b.table(c):""}},e.notify(),e.notify.group("Automatic Audience Manager Setter! "+b.version),e.serialize=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},e.serviceCall=function(a,c){if(1==e.dat.behavior.serviceCall){var d=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},f=e.cookie.get(e.dat.cookie.aamUUID),g="https://www.google-analytics.com/collect";if("object"==typeof a){var h="undefined"!=typeof a.name?a.name:"",i="undefined"!=typeof a.message?a.message:"",j="undefined"!=typeof a.lineNumber?a.lineNumber:"",k="undefined"!=typeof a.columnNumber?a.columnNumber:"";desc=h+": "+i+" - Line: "+j+" - Col: "+k}else desc=a;var l={v:"1",tid:"UA-10339556-7",cid:""!=f?f:d(1e9,19e8),t:"event",dh:location.hostname,ec:"AAM",ea:c||"Failure",el:b.version,cd12:desc},m=g+"?"+e.serialize(l);e.notify.log(m,1);var n=new Image;n.src=m}else e.notify.log("Tracking failed!",4)};try{if(e.decode=function(a){if(!("undefined"!=typeof a&&a.length>0))return a;try{return e.notify.log("[decoder] : Original string: "+a,1),a=decodeURIComponent(unescape(unescape(a))),a=a.replace("+"," ")}catch(b){return e.notify.log("[decoder] : String is not UTF8 valid",4),a}},e.notify.groupCollapsed("TASK: Self detection"),e.time={cookieName:e.dat.cookie.aamLast||"aam_last",last:function(a){var a=e.cookie.get(e.time.cookieName);return""==a?(cu=e.time.update(),e.notify.log("First TIME: "+cu,1),cu):(e.notify.log("LAST TIME: "+a,1),a)},current:function(){var a=new Date;return a.getTime()},update:function(a){var b="undefined"==typeof a?e.time.cookieName:a,c=e.time.current();return e.cookie.set(b,c,60),c}},e.randomIntFromInterval=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},e.loadAsyncScript=function(a,b,c){try{var f,g,h;g=!1,f=document.createElement("script"),f.type="text/javascript",f.src=a,f.onload=f.onreadystatechange=function(){!b||g||this.readyState&&"complete"!=this.readyState||(g=!0,b())},f.onerror=function(){!c||g||this.readyState&&"complete"!=this.readyState||(g=!0,c())},h=document.getElementsByTagName("script")[0],h.parentNode.insertBefore(f,h)}catch(a){e.notify.log("Async load failed + "+a,4)}},e.allowTracking=!0,e.killSwitch=function(a,b){return 1==a?(e.notify.log("Tracking excluded by "+(b?b:"Mr Nobody")+"!",1),e.allowTracking=!1,!1):0==a?(e.notify.log((b?b:"Mr Nobody")+" tracking allowed!",1),!0):void 0},e.notify.groupEnd(),e.SA2={},e.getSA2=function(a,b){var c=e.SA2;return"undefined"!=typeof c[a]&&"undefined"!=typeof c[a].v&&c[a].v},e.setSA2=function(a){var b=["v","s","r","t","p","l","o"],c="[set SA2] <- ";for(var d in a){if(a.hasOwnProperty(d)){c+=d;var f=[],g=a[d];if("undefined"!=typeof e.SA2[d]&&"undefined"!=typeof e.SA2[d].o&&e.isIn("c",e.SA2[d].o))return e.notify.log(c+" - Can not be overwritten, signal canceled!",4),!1;for(var h in a[d])if(e.isIn(h,b,!0)){switch(e.notify.log("Allowed signal "+h+" "+e.isIn(h,b,!0),1),f.push(h),h){case"o":e.isIn("c",g[h])||e.notify.log("THIS SIGNAl IS UNIQUE",1),e.notify.log(g[h],1)}"undefined"==typeof g[h]&&"undefined"==g[h]&&""==g[h]&&void 0==g[h]||("v"==h&&(e.SA2[d]={}),e.SA2[d][h]=g[h]),c+=" | "+h+" : "+g[h]}}e.notify.log(c,1)}},e.signalAnatomy={},e.set=function(a,b,c){var d=["val","private","time_last","time_ltv","owner","persistent"],f="[set] <- ";if(e.isEmpty(e.signalAnatomy[a])&&(e.signalAnatomy[a]={}),"object"!=typeof b)f+="Simple signal '"+a+"' setted - '"+b+"'",e.signalAnatomy[a].val=b,"boolean"==typeof c&&(e.signalAnatomy[a].private=c);else{f+="Signal '"+a+"'";for(var g in b)b.hasOwnProperty(g)&&e.isIn(g,d)&&(("impsm"==a||"persistent"==g&&1==b[g])&&(cooname=e.dat.cookie.aamSignalStoragePrefix||"aam_sig_",e.cookie.set(cooname+a,JSON.stringify(b),60)),"undefined"==typeof b[g]&&"undefined"==b[g]&&""==b[g]&&void 0==b[g]||(e.signalAnatomy[a][g]=b[g]),f+=" | "+g+" : "+b[g])}e.notify.log(f,1),e.signalAnatomy[a].time_last=e.time.current()},e.customData=function(){e.notify.groupCollapsed("SIGNALS: DATALAYER");var a="object"==typeof aamDataLayer?aamDataLayer:{};if(e.custom)for(var b in e.custom)a[b]=e.custom[b];for(var c in a){var d="",f={};if(a.hasOwnProperty(c)){var d=c;for(var g in a[c])if(a.hasOwnProperty(c)&&("undefined"!=typeof a[c].val&&(f.val=a[c].val),"undefined"!=typeof a[c].private)){var h=a[c][g];"boolean"==typeof a[c][g]?f.private=h:1!==h&&0!==h||(f.private=1==h)}f.owner="dataLayer",e.set(d,f)}}e.notify.groupEnd()},e.prepareSignals=function(){e.notify.groupCollapsed("TASK: Prepare signals from signalAnatomy scheme");var a=!e.dat.shared,b=e.signalAnatomy;for(var d in b)if(b.hasOwnProperty(d)){var f="";if("boolean"==typeof b[d].private?(a=b[d].private,f=" and private call is forced to: "+a):a="advertiser"==e.dat.state||!e.dat.shared,e.isEmpty(b[d].val)&&"number"!=typeof b[d].val&&e.dat.shortener)e.notify.log("Prepare Stage: Signal '"+d+"' was canceled!",1);else{var g="c_"+(a?"advertiser"==e.dat.state?"a_":"p_":"")+d,h=b[d].val,i={n:g,v:h};e.notify.log("Prepare Stage: "+g+": "+h+f,1),e.signalQueue[i.n]=i.v}}e.notify.groupEnd()},e.getQueryParam=function(a){if(a=new RegExp("[?&]"+encodeURIComponent(a)+"=([^&]*)").exec(location.search))return decodeURIComponent(a[1])},e.get=function(a){var b={pagedescription:function(){if(d.getElementsByName("description").length>0){var a=d.getElementsByName("description")[0].getAttribute("content");return a}},pagehostname:function(){return location.hostname},pagekeywords:function(){if(d.getElementsByName("keywords").length>0){var a=d.getElementsByName("keywords")[0].getAttribute("content");return a}},pagetitle:function(){return d.title},pageurl:function(){return d.URL},referrer:function(){return d.referrer}},c="[getter] -> ";try{if("function"==typeof b[a]){var f=b[a],g=f();return"string"==typeof g&&g.length>0?(e.notify.log(c+"Requested value "+a+" is "+g,1),g):(e.notify.log(c+"Requested value "+a+" do not contain any value!",1),"")}return e.notify.log(c+"Requested value "+a+" does not exist!",4),""}catch(a){e.notify.log(c+"Error while delivering data "+a,1)}},e.dependencies={cookieNamePrefix:e.dat.cookie.aamTimeDependencyPrefix||"aam_td_",storage:{},register:function(a,b,c){e.dependencies.storage[a]={time:b,callback:c},e.notify.log("Registering time dependency "+a,1)},check:function(a){return e.dependencies.storage[a]}},e.callbacks={cpex_network:function(){e.notify.log("CPEX NETWORK callback",1);var a=864.0000000000001,b=864e5,c=864e5,d=e.cookie.get(e.dat.cookie.aamIdSyncTime);if(""!=d){var f=parseInt(1e3*d+b),g=parseInt(e.time.current()),h=g-f;if(e.notify.log("OldTime Corrected: "+f+" - Diff in seconds: "+(f-parseInt(e.time.current())+" - Hours"+(h<0?" to first init: ":": ")+24*Math.abs(h/c)),1),!(f<g))return e.blockFiring=!0,e.notify.log("CPEX NETWORK BLOCKING",1),!1;h/c<30?(e.notify.log("Daily update mode",1),a=864e5):(e.notify.log("Weekly update mode",1),a=6048e5),e.blockFiring=!1,e.notify.log("CPEX NETWORK TRACKING",1)}else a=1;return e.dependencies.register("cpex_network",a,function(){e.notify.log("CALLBACK FOR TIME DEPENDENCY CPEC NETWORK SYNC",1),e.callbacks.cpex_networkTimeDependency(a)}),!0},cpex_networkPostProcess:function(){e.notify.log("Time syncing finished!",1)},cpex_networkError:function(){e.notify.log("Error occured",1),e.serviceCall("CPEX Network","Error occured"),e.blockFiring=!1,e.prepareApi()},cpex_networkTimeDependency:function(a){var b="aam_time_sync";e.notify.log("TIMEDEPENDENCY CALLBACK",1),e.blockFiring=!0,c[b]=function(a){e.notify.groupCollapsed("TASK: Cpex Network Sync Callback"),e.notify.log("Custom cpex_network post setting callback",1);try{if(isNaN(a.ts)||"number"!=typeof a.uuid&&"string"!=typeof a.uuid)throw"Bad Data";var b=e.time.current()/1e3-a.ts;e.cookie.set(e.dat.cookie.aamIdSync,a.uuid,60),e.cookie.set(e.dat.cookie.aamIdSyncTime,a.ts,60),e.notify.log(a.uuid+" : "+b+"s",1),e.callbacks.cpex_network(),e.prepareApi()}catch(a){e.serviceCall("CPEX Network","Time sync failed"+a),e.blockFiring=!1,e.prepareApi()}e.notify.groupEnd()},e.loadAsyncScript("//pixel.cpex.cz/uuid.js?jsp="+b,e.callbacks.cpex_networkPostProcess,e.callbacks.cpex_networkError)}},e.slowDeploy=function(a,b,c,d,f,g){e.notify.groupCollapsed("TASK: Slow Deploy '"+a+"' ");var h=e.time.current(),i=1*b+1*c>h;if(e.notify.log((i?"Slow deploy init params: ":"Skip slow deploy: ")+" DD: "+1*b+" RMS: "+c+" FULL: "+(1*b+1*c)+" CUR: "+h+" DIFF: "+(1*b+c-h),1),i){var j=e.dat.cookie.aamSlowDeployPrefix||"aam_sd_",k=j+a,l="",m=f-d;m=m<=0?1:m>=100?100:m,l+="Range: "+m+" % | ";var n=h-b;l+="Diff: "+n/1e3+" s | ";var o=n/c*100;l+="Progress: "+o+" % | ",o=o>=100?100:o<0?0:o;var p=100/m;l+="Piece: "+p+" % | ";var q=o/p;l+="Relative gain: "+q+" % | ";var r=d+q;l+="Abslute gain: "+r+" % | ",e.notify.log(l,1),e.notify.log("Current scale is "+n+" ms - "+n/1e3+" s - "+n/1e3/60+" m - "+n/1e3/60/60+" h - "+n/1e3/60/60/24+" d",1);var s=100*Math.random();l="Random result is "+s+" % | ";var t=s<r;l+=t?"Is in slowDeploy :-)":"Is not in slowDeploy :-(";var u=e.cookie.get(k);e.notify.log(l,1)}else t=!0;""!=u?(e.notify.log("Register '"+a+"' through slow deploy",1),g()):1==t?(e.notify.log("Register for first time '"+a+"' through slow deploy",1),e.cookie.set(k,b,60),e.serviceCall(a,"Slow Deploy For First Time"),g()):e.notify.log("Currently excluded '"+a+"' due to slowDeploy",1),e.notify.groupEnd()},"undefined"!=typeof e.dat.extensions){e.notify.groupCollapsed("TASK: Extensions");var f=e.dat.extensions;for(var g in f)if(!("undefined"==typeof f[g].restrict||"undefined"!=typeof f[g].restrict&&e.isIn(d.location.hostname,e.dat.extensions[g].restrict))||"undefined"!=typeof f[g].disable&&f[g].disable===!0)e.notify.log("Feature "+g+" not allowed due restriction policy",1);else{e.notify.log("Feature "+g+" allowed",1);var i=f[g].release||e.time.current(),j=f[g].period||864e5,k=f[g].min||0,l=f[g].max||100,m=e.callbacks[g];e.slowDeploy(g,i,j,k,l,m)}e.notify.groupEnd()}e.once(function(){function a(a,b){if((b.nodeName||b.tagName).toLowerCase()===a.toLowerCase())return b;for(;b=b.parentNode;)if((b.nodeName||b.tagName).toLowerCase()===a.toLowerCase())return b;return null}function c(a){var b=/(<([^>]+)>)/gi;return a.replace(b,"")}if(e.notify.groupCollapsed("TASK: Event listeners"),e.dat.behavior.trackLinks){e.notify.log("Link Tracking Enabled",1);try{document.body.onclick=function(d){d=d||event;var f=a("a",d.target||d.srcElement);f&&(e.notify.log(typeof f.href,1),b.submitGeneric({clickurl:{val:f.href,private:!0},clickurltext:{val:c(f.innerHTML),private:!0}}))}}catch(a){e.serviceCall(a,"Link Error")}}else e.notify.log("Link Tracking Disabled",1);e.notify.groupEnd()})(),e.prepareAAM=function(){e.notify.groupCollapsed("TOOL: Audience manager setup");for(var a=e.dat.private.split(","),c=d.location.hostname,f=0,g=a.length;f<g;f++){if(a[f]==c){e.dat.shared=!1;break}e.dat.shared=!0}e.signalQueue={},e.notify.log("Registering "+e.dat.state+" "+e.dat.publisher+" in NS "+e.dat.namespace,1),e.notify.log("Code version: "+b.version,1),e.notify.log("Data are defaultly "+(e.dat.shared?"":"NOT ")+"shared across all publishers",1);try{"function"!=typeof window.DIL&&(window.DIL=function(a,b){var d,e,c=[];a!==Object(a)&&(a={});var f,g,h,i,j,k,l,m,n,o,p,q;f=a.partner,g=a.containerNSID,h=!!a.disableDestinationPublishingIframe,i=a.iframeAkamaiHTTPS,j=a.mappings,k=a.uuidCookie,l=!0===a.enableErrorReporting,m=a.visitorService,n=a.declaredId,o=!0===a.removeFinishedScriptsAndCallbacks,p=!0===a.delayAllUntilWindowLoad,q=!0===a.disableIDSyncs;var r,s,t,u,v,w,x,y;r=!0===a.disableScriptAttachment,s=!0===a.disableCORSFiring,t=!0===a.disableDefaultRequest,u=a.afterResultForDefaultRequest,v=a.dpIframeSrc,w=!0===a.testCORS,x=!0===a.useJSONPOnly,y=a.visitorConstructor,l&&DIL.errorModule.activate();var z=!0===window._dil_unit_tests;if((d=b)&&c.push(d+""),!f||"string"!=typeof f)return d="DIL partner is invalid or not specified in initConfig",DIL.errorModule.handleError({name:"error",message:d,filename:"dil.js"}),Error(d);if(d="DIL containerNSID is invalid or not specified in initConfig, setting to default of 0",(g||"number"==typeof g)&&(g=parseInt(g,10),!isNaN(g)&&0<=g&&(d="")),d&&(g=0,c.push(d),d=""),e=DIL.getDil(f,g),e instanceof DIL&&e.api.getPartner()===f&&e.api.getContainerNSID()===g)return e;if(!(this instanceof DIL))return new DIL(a,"DIL was not instantiated with the 'new' operator, returning a valid instance with partner = "+f+" and containerNSID = "+g);DIL.registerDil(this,f,g);var A={IS_HTTPS:"https:"===document.location.protocol,POST_MESSAGE_ENABLED:!!window.postMessage,COOKIE_MAX_EXPIRATION_DATE:"Tue, 19 Jan 2038 03:14:07 UTC"},B={stuffed:{}},C={},D={firingQueue:[],fired:[],firing:!1,sent:[],errored:[],reservedKeys:{sids:!0,pdata:!0,logdata:!0,callback:!0,postCallbackFn:!0,useImageRequest:!0},callbackPrefix:"demdexRequestCallback",firstRequestHasFired:!1,useJSONP:!0,abortRequests:!1,num_of_jsonp_responses:0,num_of_jsonp_errors:0,num_of_cors_responses:0,num_of_cors_errors:0,corsErrorSources:[],num_of_img_responses:0,num_of_img_errors:0,toRemove:[],removed:[],readyToRemove:!1,platformParams:{d_nsid:g+"",d_rtbd:"json",d_jsonv:DIL.jsonVersion+"",d_dst:"1"},nonModStatsParams:{d_rtbd:!0,d_dst:!0,d_cts:!0,d_rs:!0},modStatsParams:null,adms:{TIME_TO_CATCH_ALL_REQUESTS_RELEASE:2e3,calledBack:!1,mid:null,noVisitorAPI:!1,instance:null,releaseType:"no VisitorAPI",admsProcessingStarted:!1,process:function(a){try{if(!this.admsProcessingStarted){this.admsProcessingStarted=!0;var c,d,e,f,h,b=this;if("function"==typeof a&&"function"==typeof a.getInstance){if(m!==Object(m)||!(c=m.namespace)||"string"!=typeof c)return this.releaseType="no namespace",void this.releaseRequests();if(d=a.getInstance(c,{idSyncContainerID:g}),d===Object(d)&&"function"==typeof d.isAllowed&&"function"==typeof d.getMarketingCloudVisitorID&&"function"==typeof d.getCustomerIDs)return d.isAllowed()?(this.instance=d,e=function(a){"VisitorAPI"!==b.releaseType&&(b.mid=a,b.releaseType="VisitorAPI",b.releaseRequests())},z&&(f=m.server)&&"string"==typeof f&&(d.server=f),h=d.getMarketingCloudVisitorID(e),"string"==typeof h&&h.length?void e(h):void setTimeout(function(){"VisitorAPI"!==b.releaseType&&(b.releaseType="timeout",b.releaseRequests())},this.TIME_TO_CATCH_ALL_REQUESTS_RELEASE)):(this.releaseType="VisitorAPI not allowed",void this.releaseRequests());this.releaseType="invalid instance"}else this.noVisitorAPI=!0;this.releaseRequests()}}catch(a){this.releaseRequests()}},releaseRequests:function(){this.calledBack=!0,D.registerRequest()},getMarketingCloudVisitorID:function(){return this.instance?this.instance.getMarketingCloudVisitorID():null},getMIDQueryString:function(){var a=H.isPopulatedString,b=this.getMarketingCloudVisitorID();return a(this.mid)&&this.mid===b||(this.mid=b),a(this.mid)?"d_mid="+this.mid+"&":""},getCustomerIDs:function(){return this.instance?this.instance.getCustomerIDs():null},getCustomerIDsQueryString:function(a){if(a===Object(a)){var e,f,b="",c=[],d=[];for(e in a)a.hasOwnProperty(e)&&(d[0]=e,f=a[e],f===Object(f)&&(d[1]=f.id||"",d[2]=f.authState||0,c.push(d),d=[]));if(d=c.length)for(a=0;a<d;a++)b+="&d_cid_ic="+c[a].join("%01");return b}return""}},declaredId:{declaredId:{init:null,request:null},declaredIdCombos:{},setDeclaredId:function(a,b){var c=H.isPopulatedString,d=encodeURIComponent;if(a===Object(a)&&c(b)){var e=a.dpid,f=a.dpuuid,g=null;if(c(e)&&c(f))return g=d(e)+"$"+d(f),!0===this.declaredIdCombos[g]?"setDeclaredId: combo exists for type '"+b+"'":(this.declaredIdCombos[g]=!0,this.declaredId[b]={dpid:e,dpuuid:f},"setDeclaredId: succeeded for type '"+b+"'")}return"setDeclaredId: failed for type '"+b+"'"},getDeclaredIdQueryString:function(){var a=this.declaredId.request,b=this.declaredId.init,c="";return null!==a?c="&d_dpid="+a.dpid+"&d_dpuuid="+a.dpuuid:null!==b&&(c="&d_dpid="+b.dpid+"&d_dpuuid="+b.dpuuid),c}},registerRequest:function(a){var b=this.firingQueue;a===Object(a)&&b.push(a),this.firing||!b.length||p&&!DIL.windowLoaded||!this.adms.calledBack||(a=b.shift(),a.src=a.src.replace(/demdex.net\/event\?d_nsid=/,"demdex.net/event?"+this.adms.getMIDQueryString()+"d_nsid="),H.isPopulatedString(a.corsPostData)&&(a.corsPostData=a.corsPostData.replace(/^d_nsid=/,this.adms.getMIDQueryString()+"d_nsid=")),G.fireRequest(a),this.firstRequestHasFired||"script"!==a.tag&&"cors"!==a.tag||(this.firstRequestHasFired=!0))},processVisitorAPI:function(){this.adms.process(y||window.Visitor)},requestRemoval:function(a){if(!o)return"removeFinishedScriptsAndCallbacks is not boolean true";var c,d,b=this.toRemove;if(a===Object(a)&&(c=a.script,d=a.callbackName,(c===Object(c)&&"SCRIPT"===c.nodeName||"no script created"===c)&&"string"==typeof d&&d.length&&b.push(a)),this.readyToRemove&&b.length){d=b.shift(),c=d.script,d=d.callbackName,"no script created"!==c?(a=c.src,c.parentNode.removeChild(c)):a=c,window[d]=null;try{delete window[d]}catch(a){}return this.removed.push({scriptSrc:a,callbackName:d}),DIL.variables.scriptsRemoved.push(a),DIL.variables.callbacksRemoved.push(d),this.requestRemoval()}return"requestRemoval() processed"}};e=function(){var a="http://fast.",b="?d_nsid="+g+"#"+encodeURIComponent(document.location.href);return"string"==typeof v&&v.length?v+b:(A.IS_HTTPS&&(a=!0===i?"https://fast.":"https://"),a+f+".demdex.net/dest5.html"+b)};var E={THROTTLE_START:3e4,throttleTimerSet:!1,id:"destination_publishing_iframe_"+f+"_"+g,url:e(),iframe:null,iframeHasLoaded:!1,sendingMessages:!1,messages:[],messagesPosted:[],messageSendingInterval:A.POST_MESSAGE_ENABLED?15:100,ibsDeleted:[],jsonProcessed:[],newIframeCreated:null,iframeIdChanged:!1,originalIframeHasLoadedAlready:null,attachIframe:function(){function a(){d=document.createElement("iframe"),d.id=c.id,d.style.cssText="display: none; width: 0; height: 0;",d.src=c.url,c.newIframeCreated=!0,b(),document.body.appendChild(d)}function b(){I.addListener(d,"load",function(){d.className="aamIframeLoaded",c.iframeHasLoaded=!0,c.requestToProcess()})}var c=this,d=document.getElementById(this.id);d?"IFRAME"!==d.nodeName?(this.id+="_2",this.iframeIdChanged=!0,a()):(this.newIframeCreated=!1,"aamIframeLoaded"!==d.className?(this.originalIframeHasLoadedAlready=!1,b()):(this.iframeHasLoaded=this.originalIframeHasLoadedAlready=!0,this.requestToProcess())):a(),this.iframe=d},requestToProcess:function(a,b){var c=this;a&&!H.isEmptyObject(a)&&this.process(a,b),this.iframeHasLoaded&&this.messages.length&&!this.sendingMessages&&(this.throttleTimerSet||(this.throttleTimerSet=!0,setTimeout(function(){c.messageSendingInterval=A.POST_MESSAGE_ENABLED?15:150},this.THROTTLE_START)),this.sendingMessages=!0,this.sendMessages())},process:function(a,b){var d,e,f,g,h,i,c=encodeURIComponent;if(b===Object(b)&&(i=I.encodeAndBuildRequest(["",b.dpid||"",b.dpuuid||""],",")),(d=a.dests)&&d instanceof Array&&(e=d.length))for(f=0;f<e;f++)g=d[f],g=[c("dests"),c(g.id||""),c(g.y||""),c(g.c||"")],this.addMessage(g.join("|"));if((d=a.ibs)&&d instanceof Array&&(e=d.length))for(f=0;f<e;f++)g=d[f],g=[c("ibs"),c(g.id||""),c(g.tag||""),I.encodeAndBuildRequest(g.url||[],","),c(g.ttl||""),"",i],this.addMessage(g.join("|"));if((d=a.dpcalls)&&d instanceof Array&&(e=d.length))for(f=0;f<e;f++)g=d[f],h=g.callback||{},h=[h.obj||"",h.fn||"",h.key||"",h.tag||"",h.url||""],g=[c("dpm"),c(g.id||""),c(g.tag||""),I.encodeAndBuildRequest(g.url||[],","),c(g.ttl||""),I.encodeAndBuildRequest(h,","),i],this.addMessage(g.join("|"));this.jsonProcessed.push(a)},addMessage:function(a){var b=encodeURIComponent,b=b(l?"---destpub-debug---":"---destpub---");this.messages.push(b+a)},sendMessages:function(){var b,a=this;this.messages.length?(b=this.messages.shift(),DIL.xd.postMessage(b,this.url,this.iframe.contentWindow),this.messagesPosted.push(b),setTimeout(function(){a.sendMessages()},this.messageSendingInterval)):this.sendingMessages=!1}},F={traits:function(a){return H.isValidPdata(a)&&(C.sids instanceof Array||(C.sids=[]),I.extendArray(C.sids,a)),this},pixels:function(a){return H.isValidPdata(a)&&(C.pdata instanceof Array||(C.pdata=[]),I.extendArray(C.pdata,a)),this},logs:function(a){return H.isValidLogdata(a)&&(C.logdata!==Object(C.logdata)&&(C.logdata={}),I.extendObject(C.logdata,a)),this},customQueryParams:function(a){return H.isEmptyObject(a)||I.extendObject(C,a,D.reservedKeys),this},signals:function(a,b){var c,d=a;if(!H.isEmptyObject(d)){if(b&&"string"==typeof b)for(c in d={},a)a.hasOwnProperty(c)&&(d[b+c]=a[c]);I.extendObject(C,d,D.reservedKeys)}return this},declaredId:function(a){return D.declaredId.setDeclaredId(a,"request"),this},result:function(a){return"function"==typeof a&&(C.callback=a),this},afterResult:function(a){return"function"==typeof a&&(C.postCallbackFn=a),this},useImageRequest:function(){return C.useImageRequest=!0,this},clearData:function(){return C={},this},submit:function(){return G.submitRequest(C),C={},this},getPartner:function(){return f},getContainerNSID:function(){return g},getEventLog:function(){return c},getState:function(){var a={},b={};return I.extendObject(a,D,{callbackPrefix:!0,useJSONP:!0,registerRequest:!0}),I.extendObject(b,E,{attachIframe:!0,requestToProcess:!0,process:!0,sendMessages:!0}),{pendingRequest:C,otherRequestInfo:a,destinationPublishingInfo:b}},idSync:function(a){if(q)return"Error: id syncs have been disabled";if(a!==Object(a)||"string"!=typeof a.dpid||!a.dpid.length)return"Error: config or config.dpid is empty";if("string"!=typeof a.url||!a.url.length)return"Error: config.url is empty";var e,b=a.url,c=a.minutesToLive,d=encodeURIComponent,b=b.replace(/^https:/,"").replace(/^http:/,"");if("undefined"==typeof c)c=20160;else if(c=parseInt(c,10),isNaN(c)||0>=c)return"Error: config.minutesToLive needs to be a positive number";return e=I.encodeAndBuildRequest(["",a.dpid,a.dpuuid||""],","),a=["ibs",d(a.dpid),"img",d(b),c,"",e],E.addMessage(a.join("|")),D.firstRequestHasFired&&E.requestToProcess(),"Successfully queued"},aamIdSync:function(a){return q?"Error: id syncs have been disabled":a===Object(a)&&"string"==typeof a.dpuuid&&a.dpuuid.length?(a.url="//dpm.demdex.net/ibs:dpid="+a.dpid+"&dpuuid="+a.dpuuid,this.idSync(a)):"Error: config or config.dpuuid is empty"},passData:function(a){return H.isEmptyObject(a)?"Error: json is empty or not an object":(E.ibsDeleted.push(a.ibs),delete a.ibs,G.defaultCallback(a),a)},getPlatformParams:function(){return D.platformParams},getEventCallConfigParams:function(){var d,a=D,b=a.modStatsParams,c=a.platformParams;if(!b){b={};for(d in c)c.hasOwnProperty(d)&&!a.nonModStatsParams[d]&&(b[d.replace(/^d_/,"")]=c[d]);a.modStatsParams=b}return b}},G={corsMetadata:function(){var a="none",b=!0;return"undefined"!=typeof XMLHttpRequest&&XMLHttpRequest===Object(XMLHttpRequest)&&("withCredentials"in new XMLHttpRequest?a="XMLHttpRequest":new Function("/*@cc_on return /^10/.test(@_jscript_version) @*/")()?a="XMLHttpRequest":"undefined"!=typeof XDomainRequest&&XDomainRequest===Object(XDomainRequest)&&(b=!1),0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")&&(b=!1)),{corsType:a,corsCookiesEnabled:b}}(),getCORSInstance:function(){return"none"===this.corsMetadata.corsType?null:new window[this.corsMetadata.corsType]},submitRequest:function(a){return D.registerRequest(G.createQueuedRequest(a)),!0},createQueuedRequest:function(a){var c,f,b=D,d=a.callback,e="img";if(!H.isEmptyObject(j)){var h,i,k;for(h in j)!j.hasOwnProperty(h)||(i=j[h],null==i||""===i||!(h in a)||i in a||i in D.reservedKeys)||(k=a[h],null==k||""===k||(a[i]=k))}return H.isValidPdata(a.sids)||(a.sids=[]),H.isValidPdata(a.pdata)||(a.pdata=[]),H.isValidLogdata(a.logdata)||(a.logdata={}),a.logdataArray=I.convertObjectToKeyValuePairs(a.logdata,"=",!0),a.logdataArray.push("_ts="+(new Date).getTime()),"function"!=typeof d&&(d=this.defaultCallback),b.useJSONP=!0!==a.useImageRequest,b.useJSONP&&(e="script",c=b.callbackPrefix+"_"+g+"_"+(new Date).getTime()),b=this.makeRequestSrcData(a,c),!x&&(f=this.getCORSInstance())&&b.truncated&&(this.corsMetadata.corsCookiesEnabled||b.isDeclaredIdCall)&&(e="cors"),{tag:e,src:b.src,corsSrc:b.corsSrc,internalCallbackName:c,callbackFn:d,postCallbackFn:a.postCallbackFn,useImageRequest:!!a.useImageRequest,requestData:a,corsInstance:f,corsPostData:b.corsPostData,hasCORSError:!1}},defaultCallback:function(a,b){var c,d,e,f,g,i,j,l,m;if((c=a.stuff)&&c instanceof Array&&(d=c.length))for(e=0;e<d;e++)(f=c[e])&&f===Object(f)&&(g=f.cn,i=f.cv,j=f.ttl,"undefined"!=typeof j&&""!==j||(j=Math.floor(I.getMaxCookieExpiresInMinutes()/60/24)),l=f.dmn||"."+document.domain.replace(/^www\./,""),m=f.type,g&&(i||"number"==typeof i)&&("var"!==m&&(j=parseInt(j,10))&&!isNaN(j)&&I.setCookie(g,i,1440*j,"/",l,!1),B.stuffed[g]=i));c=a.uuid,H.isPopulatedString(c)&&!H.isEmptyObject(k)&&(d=k.path,"string"==typeof d&&d.length||(d="/"),e=parseInt(k.days,10),isNaN(e)&&(e=100),I.setCookie(k.name||"aam_did",c,1440*e,d,k.domain||"."+document.domain.replace(/^www\./,""),!0===k.secure)),!h&&!D.abortRequests&&E.requestToProcess(a,b)},makeRequestSrcData:function(a,b){a.sids=H.removeEmptyArrayValues(a.sids||[]),a.pdata=H.removeEmptyArrayValues(a.pdata||[]);var c=D,d=c.platformParams,e=I.encodeAndBuildRequest(a.sids,","),h=I.encodeAndBuildRequest(a.pdata,","),i=(a.logdataArray||[]).join("&");delete a.logdataArray;var m,j=A.IS_HTTPS?"https://":"http://",k=c.declaredId.getDeclaredIdQueryString(),l=c.adms.instance?c.adms.getCustomerIDsQueryString(c.adms.getCustomerIDs()):"";m=[];var n,o,p,q;for(n in a)if(!(n in c.reservedKeys)&&a.hasOwnProperty(n))if(o=a[n],n=encodeURIComponent(n),o instanceof Array)for(p=0,q=o.length;p<q;p++)m.push(n+"="+encodeURIComponent(o[p]));else m.push(n+"="+encodeURIComponent(o));return m=m.length?"&"+m.join("&"):"",n=!1,e="d_nsid="+d.d_nsid+k+l+(e.length?"&d_sid="+e:"")+(h.length?"&d_px="+h:"")+(i.length?"&d_ld="+encodeURIComponent(i):""),d="&d_rtbd="+d.d_rtbd+"&d_jsonv="+d.d_jsonv+"&d_dst="+d.d_dst,j=j+f+".demdex.net/event",h=c=j+"?"+e+(c.useJSONP?d+"&d_cb="+(b||""):"")+m,2048<c.length&&(c=c.substring(0,c.lastIndexOf("&")),n=!0),{corsSrc:j+"?"+(w?"testcors=1&d_nsid="+g+"&":"")+"_ts="+(new Date).getTime(),src:c,originalSrc:h,truncated:n,corsPostData:e+d+m,isDeclaredIdCall:""!==k}},fireRequest:function(a){if("img"===a.tag)this.fireImage(a);else{var b=D.declaredId,b=b.declaredId.request||b.declaredId.init||{},b={dpid:b.dpid||"",dpuuid:b.dpuuid||""};"script"===a.tag?this.fireScript(a,b):"cors"===a.tag&&this.fireCORS(a,b)}},fireImage:function(a){var e,f,b=D;b.abortRequests||(b.firing=!0,e=new Image(0,0),b.sent.push(a),e.onload=function(){b.firing=!1,b.fired.push(a),b.num_of_img_responses++,b.registerRequest()},f=function(e){d="imgAbortOrErrorHandler received the event of type "+e.type,c.push(d),b.abortRequests=!0,b.firing=!1,b.errored.push(a),b.num_of_img_errors++,b.registerRequest()},e.addEventListener?(e.addEventListener("error",f,!1),e.addEventListener("abort",f,!1)):e.attachEvent&&(e.attachEvent("onerror",f),e.attachEvent("onabort",f)),e.src=a.src)},fireScript:function(a,b){var h,i,e=this,g=D,j=a.src,k=a.postCallbackFn,l="function"==typeof k,m=a.internalCallbackName;g.abortRequests||(g.firing=!0,window[m]=function(e){try{e!==Object(e)&&(e={}),q&&(E.ibsDeleted.push(e.ibs),delete e.ibs);var h=a.callbackFn;g.firing=!1,g.fired.push(a),g.num_of_jsonp_responses++,h(e,b),l&&k(e,b)}catch(a){a.message="DIL jsonp callback caught error with message "+a.message,d=a.message,c.push(d),a.filename=a.filename||"dil.js",a.partner=f,DIL.errorModule.handleError(a);try{h({error:a.name+"|"+a.message},b),l&&k({error:a.name+"|"+a.message},b)}catch(a){}}finally{g.requestRemoval({script:i,callbackName:m}),g.registerRequest()}},r?(g.firing=!1,g.requestRemoval({script:"no script created",callbackName:m})):(i=document.createElement("script"),i.addEventListener&&i.addEventListener("error",function(b){g.requestRemoval({script:i,callbackName:m}),d="jsonp script tag error listener received the event of type "+b.type+" with src "+j,e.handleScriptError(d,a)},!1),i.type="text/javascript",i.src=j,h=DIL.variables.scriptNodeList[0],h.parentNode.insertBefore(i,h)),g.sent.push(a),g.declaredId.declaredId.request=null)},fireCORS:function(a,b){function e(e){var i;try{if(i=JSON.parse(e),i!==Object(i))return void g.handleCORSError(a,b,"Response is not JSON")}catch(c){return void g.handleCORSError(a,b,"Error parsing response as JSON")}try{var j=a.callbackFn;h.firing=!1,h.fired.push(a),h.num_of_cors_responses++,j(i,b),n&&m(i,b)}catch(a){a.message="DIL handleCORSResponse caught error with message "+a.message,d=a.message,c.push(d),a.filename=a.filename||"dil.js",a.partner=f,DIL.errorModule.handleError(a);try{j({error:a.name+"|"+a.message},b),n&&m({error:a.name+"|"+a.message},b)}catch(a){}}finally{h.registerRequest()}}var g=this,h=D,i=this.corsMetadata.corsType,j=a.corsSrc,k=a.corsInstance,l=a.corsPostData,m=a.postCallbackFn,n="function"==typeof m;if(!h.abortRequests){if(h.firing=!0,s)h.firing=!1;else try{k.open("post",j,!0),"XMLHttpRequest"===i?(k.withCredentials=!0,k.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),k.onreadystatechange=function(){4===this.readyState&&(200===this.status?e(this.responseText):g.handleCORSError(a,b,"onreadystatechange"))}):"XDomainRequest"===i&&(k.onload=function(){e(this.responseText)}),k.onerror=function(){g.handleCORSError(a,b,"onerror")},k.ontimeout=function(){g.handleCORSError(a,b,"ontimeout")},k.send(l)}catch(c){this.handleCORSError(a,b,"try-catch")}h.sent.push(a),h.declaredId.declaredId.request=null;
}},handleCORSError:function(a,b,c){a.hasCORSError||(a.hasCORSError=!0,D.num_of_cors_errors++,D.corsErrorSources.push(c),a.tag="script",this.fireScript(a,b))},handleScriptError:function(a,b){D.num_of_jsonp_errors++,this.handleRequestError(a,b)},handleRequestError:function(a,b){var d=D;c.push(a),d.abortRequests=!0,d.firing=!1,d.errored.push(b),d.registerRequest()}},H={isValidPdata:function(a){return!!(a instanceof Array&&this.removeEmptyArrayValues(a).length)},isValidLogdata:function(a){return!this.isEmptyObject(a)},isEmptyObject:function(a){if(a!==Object(a))return!0;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},removeEmptyArrayValues:function(a){for(var d,b=0,c=a.length,e=[],b=0;b<c;b++)d=a[b],"undefined"!=typeof d&&null!==d&&""!==d&&e.push(d);return e},isPopulatedString:function(a){return"string"==typeof a&&a.length}},I={addListener:function(){return document.addEventListener?function(a,b,c){a.addEventListener(b,function(a){"function"==typeof c&&c(a)},!1)}:document.attachEvent?function(a,b,c){a.attachEvent("on"+b,function(a){"function"==typeof c&&c(a)})}:void 0}(),convertObjectToKeyValuePairs:function(a,b,c){var e,f,d=[];b||(b="=");for(e in a)a.hasOwnProperty(e)&&(f=a[e],"undefined"!=typeof f&&null!==f&&""!==f&&d.push(e+b+(c?encodeURIComponent(f):f)));return d},encodeAndBuildRequest:function(a,b){return this.map(a,function(a){return encodeURIComponent(a)}).join(b)},map:function(a,b){if(Array.prototype.map)return a.map(b);if(void 0===a||null===a)throw new TypeError;var c=Object(a),d=c.length>>>0;if("function"!=typeof b)throw new TypeError;for(var e=Array(d),f=0;f<d;f++)f in c&&(e[f]=b.call(b,c[f],f,c));return e},filter:function(a,b){if(!Array.prototype.filter){if(void 0===a||null===a)throw new TypeError;var c=Object(a),d=c.length>>>0;if("function"!=typeof b)throw new TypeError;for(var e=[],f=0;f<d;f++)if(f in c){var g=c[f];b.call(b,g,f,c)&&e.push(g)}return e}return a.filter(b)},getCookie:function(a){a+="=";var c,d,e,b=document.cookie.split(";");for(c=0,d=b.length;c<d;c++){for(e=b[c];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(a))return decodeURIComponent(e.substring(a.length,e.length))}return null},setCookie:function(a,b,c,d,e,f){var g=new Date;c&&(c*=6e4),document.cookie=a+"="+encodeURIComponent(b)+(c?";expires="+new Date(g.getTime()+c).toUTCString():"")+(d?";path="+d:"")+(e?";domain="+e:"")+(f?";secure":"")},extendArray:function(a,b){return a instanceof Array&&b instanceof Array&&(Array.prototype.push.apply(a,b),!0)},extendObject:function(a,b,c){var d;if(a===Object(a)&&b===Object(b)){for(d in b)!b.hasOwnProperty(d)||!H.isEmptyObject(c)&&d in c||(a[d]=b[d]);return!0}return!1},getMaxCookieExpiresInMinutes:function(){return(new Date(A.COOKIE_MAX_EXPIRATION_DATE).getTime()-(new Date).getTime())/1e3/60}};"error"===f&&0===g&&I.addListener(window,"load",function(){DIL.windowLoaded=!0});var J=!1,K=function(){J||(J=!0,D.registerRequest(),L(),!h&&!D.abortRequests&&E.attachIframe(),D.readyToRemove=!0,D.requestRemoval())},L=function(){h||setTimeout(function(){!t&&!D.firstRequestHasFired&&("function"==typeof u?F.afterResult(u).submit():F.submit())},DIL.constants.TIME_TO_DEFAULT_REQUEST)},M=document;"error"!==f&&(DIL.windowLoaded?K():"complete"!==M.readyState&&"loaded"!==M.readyState?I.addListener(window,"load",function(){DIL.windowLoaded=!0,K()}):(DIL.windowLoaded=!0,K())),D.declaredId.setDeclaredId(n,"init"),D.processVisitorAPI(),this.api=F,this.getStuffedVariable=function(a){var b=B.stuffed[a];return!b&&"number"!=typeof b&&(b=I.getCookie(a),!b&&"number"!=typeof b&&(b="")),b},this.validators=H,this.helpers=I,this.constants=A,this.log=c,z&&(this.pendingRequest=C,this.requestController=D,this.setDestinationPublishingUrl=e,this.destinationPublishing=E,this.requestProcs=G,this.variables=B,this.callWindowLoadFunctions=K)},function(){var b,a=document;null==a.readyState&&a.addEventListener&&(a.readyState="loading",a.addEventListener("DOMContentLoaded",b=function(){a.removeEventListener("DOMContentLoaded",b,!1),a.readyState="complete"},!1))}(),DIL.extendStaticPropertiesAndMethods=function(a){var b;if(a===Object(a))for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},DIL.extendStaticPropertiesAndMethods({version:"6.2",jsonVersion:1,constants:{TIME_TO_DEFAULT_REQUEST:50},variables:{scriptNodeList:document.getElementsByTagName("script"),scriptsRemoved:[],callbacksRemoved:[]},windowLoaded:!1,dils:{},isAddedPostWindowLoad:function(a){this.windowLoaded="function"==typeof a?!!a():"boolean"!=typeof a||a},create:function(a){try{return new DIL(a)}catch(a){return new Image(0,0).src="http://error.demdex.net/event?d_nsid=0&d_px=14137&d_ld=name%3Derror%26filename%3Ddil.js%26partner%3Dno_partner%26message%3DError%2520in%2520attempt%2520to%2520create%2520DIL%2520instance%2520with%2520DIL.create()%26_ts%3D"+(new Date).getTime(),Error("Error in attempt to create DIL instance with DIL.create()")}},registerDil:function(a,b,c){b=b+"$"+c,b in this.dils||(this.dils[b]=a)},getDil:function(a,b){var c;return"string"!=typeof a&&(a=""),b||(b=0),c=a+"$"+b,c in this.dils?this.dils[c]:Error("The DIL instance with partner = "+a+" and containerNSID = "+b+" was not found")},dexGetQSVars:function(a,b,c){return b=this.getDil(b,c),b instanceof this?b.getStuffedVariable(a):""},xd:{postMessage:function(a,b,c){var d=1;b&&(window.postMessage?c.postMessage(a,b.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):b&&(c.location=b.replace(/#.*$/,"")+"#"+ +new Date+d++ +"&"+a))}}}),DIL.errorModule=function(){var a=DIL.create({partner:"error",containerNSID:0,disableDestinationPublishingIframe:!0}),b={harvestererror:14138,destpuberror:14139,dpmerror:14140,generalerror:14137,error:14137,noerrortypedefined:15021,evalerror:15016,rangeerror:15017,referenceerror:15018,typeerror:15019,urierror:15020},c=!1;return{activate:function(){c=!0},handleError:function(d){if(!c)return"DIL error module has not been activated";d!==Object(d)&&(d={});var e=d.name?(d.name+"").toLowerCase():"",f=[];return d={name:e,filename:d.filename?d.filename+"":"",partner:d.partner?d.partner+"":"no_partner",site:d.site?d.site+"":document.location.href,message:d.message?d.message+"":""},f.push(e in b?b[e]:b.noerrortypedefined),a.api.pixels(f).logs(d).useImageRequest().submit(),"DIL error report sent"},pixelMap:b}}(),DIL.tools={},DIL.modules={helpers:{handleModuleError:function(a,b,c){var d="";return b=b||"Error caught in DIL module/submodule: ",a===Object(a)?d=b+(a.message||"err has no message"):(d=b+"err is not a valid object",a={}),a.message=d,c instanceof DIL&&(a.partner=c.api.getPartner()),DIL.errorModule.handleError(a),this.errorMessage=d}}}),DIL.tools.getSearchReferrer=function(a,b){var c=DIL.getDil("error"),d=DIL.tools.decomposeURI(a||document.referrer),e="",f="",g={queryParam:"q"},e=c.helpers.filter([b===Object(b)?b:{},{hostPattern:/aol\./},{hostPattern:/ask\./},{hostPattern:/bing\./},{hostPattern:/google\./},{hostPattern:/yahoo\./,queryParam:"p"}],function(a){return!(!a.hasOwnProperty("hostPattern")||!d.hostname.match(a.hostPattern))}).shift();return e?{valid:!0,name:d.hostname,keywords:(c.helpers.extendObject(g,e),f=g.queryPattern?(e=(""+d.search).match(g.queryPattern))?e[1]:"":d.uriParams[g.queryParam],decodeURIComponent(f||"").replace(/\+|%20/g," "))}:{valid:!1,name:"",keywords:""}},DIL.tools.decomposeURI=function(a){var b=DIL.getDil("error"),c=document.createElement("a");return c.href=a||document.referrer,{hash:c.hash,host:c.host.split(":").shift(),hostname:c.hostname,href:c.href,pathname:c.pathname.replace(/^\//,""),protocol:c.protocol,search:c.search,uriParams:function(a,c){return b.helpers.map(c.split("&"),function(b){b=b.split("="),a[b.shift()]=b.shift()}),a}({},c.search.replace(/^(\/|\?)?|\/$/g,""))}},DIL.tools.getMetaTags=function(){var c,d,e,f,g,a={},b=document.getElementsByTagName("meta");for(c=0,e=arguments.length;c<e;c++)if(f=arguments[c],null!==f)for(d=0;d<b.length;d++)if(g=b[d],g.name===f){a[f]=g.content;break}return a},e.notify.log("Data Integration Layer Loaded",1);var h=e.getSA2("dpuuid"),i={partner:e.dat.partner,containerNSID:e.dat.namespace,uuidCookie:{name:e.dat.cookie.aamUUID||"aam_uuid",days:30}};h?(i.declaredId={dpuuid:h,dpid:"1768"},e.notify.log("DeclaredID has been setted to value: "+h,1)):e.notify.log("DeclaredID not exist!",1),e.dil=DIL.create(i)}catch(a){e.serviceCall(a,"DIL Failure")}e.dat.se=DIL.tools.getSearchReferrer(d.referrer,e.dat.searchEngines),e.dat.ikws="",e.dat.engines=e.dat.searchQueries||[];for(var f=0;f<e.dat.engines.length;f++)"undefined"!=typeof e.getQueryParam(e.dat.engines[f])&&(e.dat.ikws=e.getQueryParam(e.dat.engines[f]),e.notify.log("Search keyword found: "+e.dat.ikws,1));e.dat.kws=e.dat.ikws.length>0?e.dat.ikws:e.dat.se.keywords,e.set("searchengine",e.dat.se.name),e.set("searchkeywords",e.decode(e.dat.kws)),e.notify.groupEnd()},e.construct=function(){if(function(){e.notify.groupCollapsed("TASK: Time Dependencies");var a=e.dat.cookie.aamTimeDependencyPrefix||"aam_td_",b=e.dependencies.storage;for(var c in b)if(b.hasOwnProperty(c)){e.notify.log("DEPENDENCY: '"+c+"' was found and it is processed!",1);var d=a+c,f=e.cookie.get(d),g=e.time.current();g-f>b[c].time||""==f?(e.notify.log("Dependency '"+c+"' was activated and callback was requested!",1),b[c].callback(),e.time.update(d)):e.notify.log("Dependency '"+c+"' was not activated! Time diff: "+(g-f)/1e3+" sec; time missing: "+(g-f-b[c].time)/1e3+" sec",1)}e.time.update(),e.notify.groupEnd()}(),e.notify.group("SIGNALS: ENVIRONMENT DETECTOR"),"string"==typeof c.aamDeclaredID&&c.aamDeclaredID.length>0){e.setSA2({dpuuid:{v:c.aamDeclaredID,t:"-i",l:9e9,o:"-c"}});var a=e.getSA2("dpuuid");a&&(e.notify.log("Tracking enabled for user with DeclaredID!",1),e.allowTracking=!0,e.serviceCall("Declared ID","Allow new visitor with DID"))}e.notify.groupEnd(),e.notify.groupCollapsed("SIGNALS: BUILD IN"),e.set("pagehostname",e.get("pagehostname")),e.set("pagetitle",e.get("pagetitle")),e.set("pageurl",e.get("pageurl")),e.set("pagekeywords",e.get("pagekeywords")),e.set("pagedescription",e.get("pagedescription")),e.set("referrer",e.decode(e.get("referrer"))),e.set("publisher",e.dat.publisher,!1),e.notify.groupEnd();try{!function(){e.notify.groupCollapsed("SIGNALS: PERSISTENT COOKIES");var a=e.dat.cookie.aamSignalStoragePrefix||"aam_sig_",b=new RegExp("^"+a+"*.+="),c=e.cookie.find(b);e.notify.log(c.length>0?c:" ARE NOT AVAILABLE NOW!",1);for(sig in c)if(c.hasOwnProperty(sig)){var d=c[sig].split("="),f=d[0].substring(a.length,d[0].length);e.set(f,JSON.parse(d[1]))}e.notify.groupEnd()}()}catch(a){e.serviceCall(a,"Persistent cookies")}}()}catch(a){e.serviceCall(a,"Generic Failure")}e.prepareApi=function(){if(1==e.init)return!1;if(1==!e.allowTracking||"undefined"!=typeof e.blockFiring&&1==e.blockFiring)return e.notify.log("Killswitch",1),b.submitGeneric=e.noop,b.submitFacebook=e.noop,b.submitGoogle=e.noop,e.notify.groupEnd(),e.notify.groupEnd(),c[e.dat.api]=function(){return b};e.notify.log("Tracking allowed!",1),e.prepareAAM();try{b.submitGeneric=function(a){return e.notify.group("Callback for Submit Generic"),e.custom=a,e.customData(),e.prepareSignals(),e.dil.api.signals(e.signalQueue),e.dil.api.submit(),e.notify.log("Servercall done!",1),e.notify.groupEnd(),!0}}catch(a){e.serviceCall(a,"Submit Generic Failure")}if(b.submitFacebook=e.noop,b.submitGoogle=e.noop,"object"==typeof FB)try{FB.Event.subscribe("edge.create",function(){b.submitGeneric({action:{val:"1",private:"false"}})}),FB.Event.subscribe("comment.create",function(){b.submitGeneric({action:{val:"2",private:"false"}})})}catch(a){e.notify.log("Facebook object not found!",4)}if(1==e.dat.behavior.debug&&(e.temp=e.merge_options(e,b),window.cpex_AAM_internalLib=e.temp),e.notify.groupEnd(),e.notify.groupEnd(),1==e.dat.behavior.autofire){e.notify.log("Autofire enabled!",1);b.submitGeneric();!function(a,b){function f(){if(!d){d=!0;for(var a=0;a<c.length;a++)c[a].fn.call(window,c[a].ctx);c=[]}}function g(){"complete"===document.readyState&&f()}a=a||"docReady",b=b||window;var c=[],d=!1,e=!1;b[a]=function(a,b){return d?void setTimeout(function(){a(b)},1):(c.push({fn:a,ctx:b}),void("complete"===document.readyState?setTimeout(f,1):e||(document.addEventListener?(document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1)):(document.attachEvent("onreadystatechange",g),window.attachEvent("onload",f)),e=!0)))}}("cpex_AAM_deferred",c)}return e.init=!0,c[e.dat.api]=function(){return b}},b.refresh=e.prepareApi,e.prepareApi()}(cpex_AAM_conf);